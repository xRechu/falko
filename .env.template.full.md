# Environment Variables Template (Frontend + Backend)

Use this file as a source of truth. Do NOT commit real secrets. Copy to your deployment systems (Railway / Cloudflare Pages) and fill values there.

---

## Backend (Railway) — Medusa Server/Worker

Required
- NODE_ENV=production
- DATABASE_URL= # Postgres connection string (Neon/Supabase/PG). Example: postgresql://user:pass@host:port/db?sslmode=require
- JWT_SECRET= # long random string
- COOKIE_SECRET= # long random string
- BACKEND_PUBLIC_URL= # public URL of the backend server (Railway) – e.g. https://backend.example.app

Optional (Redis / Event Bus / Workflows)
- REDIS_URL= # rediss://... (Upstash or other). If unset, Medusa falls back to in-memory
- MEDUSA_WORKER_MODE= # server | worker | shared (recommended: server for web, worker for worker service)
- MEDUSA_DISABLE_ADMIN= # true/false

CORS
- STORE_CORS= # comma-separated origins for store frontends (e.g. https://falkoproject.com,https://falkoproject.pages.dev)
- ADMIN_CORS= # comma-separated admin origins
- AUTH_CORS= # comma-separated auth origins

Email (choose one provider)
- RESEND_API_KEY=
- RESEND_FROM_EMAIL=
# or
- SENDGRID_API_KEY=
- SENDGRID_FROM_EMAIL=

Cloudflare R2 (S3-compatible)
- R2_ENDPOINT= # https://<accountid>.r2.cloudflarestorage.com
- R2_REGION=auto
- R2_ACCESS_KEY_ID=
- R2_SECRET_ACCESS_KEY=
- R2_BUCKET=
- R2_PUBLIC_BASE_URL= # optional public CDN domain pointing to R2 (e.g. https://cdn.example.com)

Furgonetka (Shipping)
- FURGONETKA_BASE_URL= # e.g. https://api.sandbox.furgonetka.pl
- FURGONETKA_OAUTH_CLIENT_ID=
- FURGONETKA_OAUTH_CLIENT_SECRET=
- FURGONETKA_AUTH_TOKEN= # optional
- FURGONETKA_COMPANY_ID= # optional
- FURGONETKA_USER_EMAIL= # optional
- FURGONETKA_PARTNER_USER_ID= # optional (impersonation)

Furgonetka – performance/controls (optional)
- FURGONETKA_POINTS_CACHE_TTL=600000
- FURGONETKA_LOCAL_RATE_LIMIT=0
- FURGONETKA_RATE_LIMIT_WINDOW_MS=60000
- FURGONETKA_RATE_LIMIT_MAX=120
- FURGONETKA_BREAKER_FAILURE_THRESHOLD=0
- FURGONETKA_BREAKER_COOLDOWN_MS=60000
- FURGONETKA_FEATURE_PREFETCH=0

---

## Frontend (Cloudflare Pages) — Next.js

Public variables (available in the browser)
- NEXT_PUBLIC_MEDUSA_BACKEND_URL= # e.g. https://backend.example.app
- NEXT_PUBLIC_MEDUSA_PUBLISHABLE_KEY= # Medusa publishable key
- NEXT_PUBLIC_FURGONETKA_USE_MOCK=0 # 1 to force using frontend mocks (dev only)
- NEXT_PUBLIC_BASE_URL= # public URL of your storefront (for redirects)
- NEXT_PUBLIC_R2_CDN_HOST= # optional if you serve images from R2 via custom domain (e.g. cdn.example.com)

Server-only variables (used by Next.js API routes on Pages; add as "secrets")
- PAYNOW_API_KEY=
- PAYNOW_SIGNATURE_KEY=
- PAYNOW_ENV=sandbox # sandbox | production

---

## Cloudflare Pages — bulk set via curl (Variables)

Replace <ACCOUNT_ID> and <PROJECT_NAME>. Use appropriate API token with Pages write access.

Create/update a variable:

curl -X PUT \
  "https://api.cloudflare.com/client/v4/accounts/<ACCOUNT_ID>/pages/projects/<PROJECT_NAME>/variables/NEXT_PUBLIC_MEDUSA_BACKEND_URL" \
  -H "Authorization: Bearer <API_TOKEN>" \
  -H "Content-Type: application/json" \
  --data '{
    "value": "https://backend.example.app",
    "environment": "production"
  }'

List variables:

curl -X GET \
  "https://api.cloudflare.com/client/v4/accounts/<ACCOUNT_ID>/pages/projects/<PROJECT_NAME>/variables" \
  -H "Authorization: Bearer <API_TOKEN>"

Create/update a secret (server-only):

curl -X PUT \
  "https://api.cloudflare.com/client/v4/accounts/<ACCOUNT_ID>/pages/projects/<PROJECT_NAME>/secrets/PAYNOW_API_KEY" \
  -H "Authorization: Bearer <API_TOKEN>" \
  -H "Content-Type: application/json" \
  --data '{
    "value": "<SECRET_VALUE>",
    "environment": "production"
  }'

Note: repeat for other NEXT_PUBLIC_* and secrets as needed (change names/values). Add --env for preview if required.

---

## Railway — quick notes
- Set the Backend variables in both services (server and worker) where applicable.
- If Upstash is disabled, remove REDIS_URL; the app will still run (event bus/workflow will be in-memory, and workflow engine not loaded on web).
- Ensure STORE_CORS includes your production and preview domains.
